
3 Tier 아키텍처
웹 / 도메인(비즈니스) / 영속성
> 웹 계층의 요청을 도메인 계층에서 서비스가 비즈니스 로직을 수행하고 도메인 엔티티가 조회 or 영속성 계층을 사용해 변경사항을 반영한다

'잘' 만들어진 계층형 아키텍처는
- 선택의 폭을 넓히고
- 변화하는 요구사항과 외부 요인에 빠르게 적응할 수 있다

다만 '잘' 만들 능력이 부족한 경우 코드에 나쁜 습관이 스며들기 쉽고, 쉽게 스며들었기 때문에 시간이 지날수록 스며든 것들이 정착해서 '소프트'웨어가 '소프트'하지 않게됨


## 그러면 어떤 부분이 나쁜 습관을 스며들기 쉽게 만드는걸까?

---

전통적인 계층형 아키텍처의 토대는 `데이터베이스` 다  
상위 레이어가 하위 레이어를 의존하기 때문에 결국 최하단 계층인 영속성 계층이 직접적으로 사용하는 데이터베이스가 토대가된 것이다.

하지만!

애플리케이션의 목적은 `비즈니스를 관장하는 규칙`, `비즈니스를 관장하는 정책` 들을 반영한 모델을 만들어 그 모델을 사용자가 편리하게 사용하게 하기 위함이다.
그래서 모델은 비즈니스적인 '행동'이 '상태'를 바꾸도록 모델링한다.

즉!
애플리케이션의 목적과 실제 구현 방식의 아귀가 맞지 않는다.

==우리는 돈을 벌기위해 비즈니스를 하므로 도메인 로직을 먼저 만들어야 한다.==
1. 도메인 로직을 우선 만들어서 우리의 도메인 지식이 정확한지 확인하고 
2. 정확한 도메인 개념을 가지고 도메인 레이어를 구성 후 웹,영속성 레이어를 만들어야 한다.


데이터베이스 중심적인 아키텍처가 만들어지는 원인은 ORM 때문이다??라고 말하는데
> 이건 잘 공감이 안되네~
> 영속성 레이어의 구현을 jdbc template을 사용해서 query를 그냥 날리도록 짜는 사람이면 동일한 문제가 나올거 같음
> 물론 ORM을 사용할때 나오는 Entity 클래스의 영속성 관점에 비즈니스 규칙, 행동을 Entity 클래스의 메소드로 섞고싶은 유혹이 들긴함

Entity를 도메인 계층에서 사용함으로 강결합이 생기게된다.
> 이건 계층형 구조에서는 당연함 하위 레이어를 의존하도록 만들었으니까

강결합으로 인해 Entity가 Domain 모델로서 사용될 가능성이 높아지게된다.
도메인 레이어가 영속성 레이어와 강결합이 되므로 도메인 레이어에 영속성 레이어의 구현 기술들
- 즉시로딩/지연로딩
- 트랜잭션
- 1,2차 캐시
같은 개념을 직,간접적으로 나마 투영되게 될 것임

종국에는 두 레이어간의 강결합으로 수정이 어려워지고 -> 계층형 아키텍처를 사용하는 본질을 흐림

---

계층형 아키텍처에서 전체적으로 적용되는 유일한 규칙
==특정한 계층에서는 같은 계층에 있는 컴포넌트나 하위 계층에만 접근 가능하다==
> 구현 계층 :: implementa

