
Nginx Unit 오픈소스 프로젝트 탄생 배경, 로드맵

10ms 지원하는 유일한 api gateway service
쿠페 인그레스 컨트롤러, 

nginx unit
nginx에서 코드 실행이 가능한 프로젝트
하나의 unit에 여러 언어와 여러 언어 버전으로 실행가능
json format으로 api를 요청해서 configuratoin을 변경할 수 있다, 어플리케이션 추가, 제외 기능도 마찬가지

스프링 프레임워크 지원 (여러 언어 프레임워크도 마찬가지)

nginx unit 옵저빌리티

통계 엔진
현재 ngxin 상태, 요청 부분, 등등
해당 통계 정보를  모니터링 툴에 연결하여 보는것도 가능할듯(그라파나))

도커이미지 지원중이니 테스트할 수 있을듯

실행 이후 api 호출을 통해 동적 구성 진행
json 형식으로 맞추어전달.

클라이언트 요청을 받기위한 리스너를 준비해야한다.
라우팅전달 
어떤 오브젝트로 전달할지 

라우트 오브젝트 
지정한 오브젝트로 온 요청이 아닌경우 default 라우트로 라우팅됨
여기에 따라 파이선 앱이던, 자바 앱이던으로 전달 가능할듯? 

프록시, 정적파일, 로드밸런싱 (기본 사용하는 기능들)
로드밸런싱의 가중치도 마찬가지로 지원함
unit은 80포트에 대한 명시가 필요하다.

nginx store에서 spring + nginx 제로 트러스트 도큐먼트 제공

데모 시연
----
python, php, js , java,로 라우트 오브젝트를 구성하고
라우팅을 통해 각 오브젝트로 요청을 전달하고 로드밸런싱 가중치를 지정하는 예시

nginx unitdms access log를 json 형식으로도 쌓을 수 있음


새로운 라우트 오브젝트를 개발자 풀에 맞춰 개발 후 배포하면 이전 기능은 유지한채로 신기능
개발은 새로운 스택으로 개발, 배포가 가능함


observability(관측가능성, 관찰가능성)
---

단순 수치를 조회하는 것은 모니터링이지만 그러한 데이터가 값, 수치가 나왔는지를 확인하는 과정을 관찰가능성,
관찰가능성 확보를 위해서는 세밀한 데이터가 필요함
집계보다 중요한건 슂ㅂ된 데이터를 분석하는 능력
문제(장애) 발생기 필요한건 고해상도, 매트릭, 로그

프로메테우스
기본은 풀 방식으로 사용하지만 , push 방식도 지원함.

카운터 매트릭 : 누적 매트릭 타입
문제 발생시 카운트 초기화 후 다시 데이터를 축적한다.
rate, irate를 통한 변화율의 추이를 보는것이 옳다.

게이지 : 온도나 사용량같은 실시간 매트릭

히스토그램: 요청에 따른 응답 지연시간 분위수 집계
구간별 분포도 , 히트맵 새성 tps측정에 주로 사용

promql
매트릭이름, 시간, 해상도( 30분간 1분의 해상도)

open telemetry **

trace(), span: 다양한 정보를 캡슐화( 디비 쿼리 까지 추적가능)

context propagation
core concept: 서비스간 트레이스 전달 규약



스프링부트 모니터링 ###
---

client jar **

프로메테우스가 nginx 매트릭을 수집하기 위해 nginx exporter를 바라보게 설정
