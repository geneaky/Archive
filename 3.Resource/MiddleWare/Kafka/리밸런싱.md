
카프카 토픽의 파티션이 증가하거나, 컨슈머 그룹의 컨슈머의 개수가 증감할때 
파티션을 컨슈머에게 다시 할당하기 위해 리밸런싱 작업을 한다

컨슈머의 부하를 파티션별로 균등하게 할당
데이터 처리 및 리밸런싱 극대화

#### 리밸런싱 과정에서 발생하는 데이터 처리 지연은 어떻게??

consumer그룹의 컨슈머에게 consumer instance id를 할당하여 static membership 옵션을 제공하면
한 번 파티션에 할당된 컨슈머는 리밸런싱의 영향을 받지 않고 계속 처리하게된다

이때 session의 max timeout 설정에 따라 consumer가 죽고 다시 살아나는 과정에서 리밸런싱 수행 시간이 달라지므로 설정을 해주어야한다

### 리밸런싱 프로토콜

eager mode
신규 컨슈머 추가시 컨슈머 그룹에 속한 모든 컨슈머들의 파티션 할당을 취소 후 파티션 할당 전략에따라 재할당하게된다
> 모든 컨슈머가 동작을 정지한 시간동안 lag이 쌓이면서 메시지 처리 시간 격차가 줄지 않을 수 있다

컨슈머 파티션 할당 전략
- range
- round robin
- sticky

### cooperative mode
리밸런스가 점진적으로 발생함
컨슈머들의 모든 파티션 할당을 취소하지 않음
개별 협력젹으로 영향받는 파티션만 재할당

컨슈머 퍼티션 할당 전략
- sticky


